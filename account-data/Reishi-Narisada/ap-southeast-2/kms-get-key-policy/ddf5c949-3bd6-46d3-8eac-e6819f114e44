{
    "Policy": "{\n  \"Version\" : \"2012-10-17\",\n  \"Statement\" : [ {\n    \"Sid\" : \"Allow access through Connect for all principals in the account that are authorized to use Connect\",\n    \"Effect\" : \"Allow\",\n    \"Principal\" : {\n      \"AWS\" : \"*\"\n    },\n    \"Action\" : [ \"kms:CreateGrant\", \"kms:Describe*\", \"kms:Get*\", \"kms:List*\" ],\n    \"Resource\" : \"*\",\n    \"Condition\" : {\n      \"StringEquals\" : {\n        \"kms:CallerAccount\" : \"416817624313\",\n        \"kms:ViaService\" : \"connect.ap-southeast-2.amazonaws.com\"\n      }\n    }\n  }, {\n    \"Sid\" : \"Allow Connect to directly describe the key\",\n    \"Effect\" : \"Allow\",\n    \"Principal\" : {\n      \"Service\" : \"connect.amazonaws.com\"\n    },\n    \"Action\" : [ \"kms:Describe*\", \"kms:Get*\", \"kms:List*\" ],\n    \"Resource\" : \"*\"\n  }, {\n    \"Sid\" : \"Allow direct access to key metadata to the account\",\n    \"Effect\" : \"Allow\",\n    \"Principal\" : {\n      \"AWS\" : \"arn:aws:iam::416817624313:root\"\n    },\n    \"Action\" : [ \"kms:Describe*\", \"kms:Get*\", \"kms:List*\", \"kms:RevokeGrant\" ],\n    \"Resource\" : \"*\"\n  }, {\n    \"Sid\" : \"Restrict direct usage\",\n    \"Effect\" : \"Deny\",\n    \"Principal\" : {\n      \"AWS\" : \"*\"\n    },\n    \"Action\" : [ \"kms:Encrypt\", \"kms:GenerateDataKey*\", \"kms:ReEncrypt*\" ],\n    \"Resource\" : \"*\",\n    \"Condition\" : {\n      \"Null\" : {\n        \"kms:ViaService\" : \"true\"\n      }\n    }\n  }, {\n    \"Sid\" : \"Restrict usage to Connect data\",\n    \"Effect\" : \"Deny\",\n    \"Principal\" : {\n      \"AWS\" : \"*\"\n    },\n    \"Action\" : [ \"kms:Encrypt\", \"kms:GenerateDataKey*\", \"kms:ReEncrypt*\" ],\n    \"Resource\" : \"*\",\n    \"Condition\" : {\n      \"Null\" : {\n        \"kms:EncryptionContext:aws:connect:OrganizationId\" : \"true\"\n      }\n    }\n  }, {\n    \"Sid\" : \"Allow access through S3 for all principals in the account that are authorized to use S3\",\n    \"Effect\" : \"Allow\",\n    \"Principal\" : {\n      \"AWS\" : \"*\"\n    },\n    \"Action\" : \"kms:Decrypt\",\n    \"Resource\" : \"*\",\n    \"Condition\" : {\n      \"StringEquals\" : {\n        \"kms:CallerAccount\" : \"416817624313\",\n        \"kms:ViaService\" : \"s3.ap-southeast-2.amazonaws.com\"\n      }\n    }\n  } ]\n}"
}